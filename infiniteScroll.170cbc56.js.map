{"mappings":"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","sources":["src/infiniteScroll.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Notiflix from 'notiflix';\nimport axios from 'axios';\nimport scrollBy from './scrollBy.js';\n\n// ======================================\n\nconst API_KEY = '33528220-6f12bec756615243821cbd5de';\nconst BASE_URL = 'https://pixabay.com/api';\nlet page = 1;\nlet per_page = 40;\nlet searchQuery = '';\nlet totalHits = 0;\nlet lightbox = '';\n\nasync function searchImage() {\n  const response = await axios.get(\n    `${BASE_URL}/?key=${API_KEY}&q=${searchQuery}&image_type=photo&per_page=${per_page}&page=${page}&orientation=horizontal&safesearch=true`\n  );\n  totalHits = response.data.totalHits;\n  nextPage();\n  return response.data.hits;\n}\n\n// =========================================\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\n\nsearchForm.addEventListener('submit', onSearch);\n\n// =========================================================\n\nconst loading = document.querySelector('.loading');\n\nwindow.addEventListener('scroll', () => {\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n\n  console.log({ scrollTop, scrollHeight, clientHeight });\n\n  if (clientHeight + scrollTop >= scrollHeight) {\n    showLoading();\n  } else if (scrollHeight - scrollTop === clientHeight) {\n    galleryEndInfo();\n  }\n});\n\nfunction showLoading() {\n  loading.classList.add('show');\n  setTimeout(fetchImages, 500);\n}\n\nfunction showRemove() {\n  loading.classList.remove('show');\n}\n\n// =======================================================\n\n// function scrollBy() {\n//   const { height: cardHeight } = document\n//     .querySelector('.gallery')\n//     .firstElementChild.getBoundingClientRect();\n\n//   window.scrollBy({\n//     top: cardHeight * 2.2,\n//     behavior: 'smooth',\n//   });\n// }\n\n// =========================================================\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  const form = e.currentTarget;\n  const value = form.elements.searchQuery.value.trim();\n  searchQuery = value;\n\n  resetPage();\n  clearGallery();\n  await fetchImages().finally(() => form.reset());\n}\n\nasync function fetchImages() {\n  try {\n    const images = await searchImage();\n    const markup = await images.reduce(\n      (markup, image) => createMarkup(image) + markup,\n      ''\n    );\n\n    appendImagesToGallery(markup);\n    lightbox.refresh();\n\n    if (totalHits > per_page && page - 1 !== 1) {\n      scrollBy();\n    }\n\n    if (totalHits === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      showRemove();\n    } else if (totalHits > 0 && page - 1 === 1) {\n      totalImages(totalHits);\n      galleryEndInfo();\n      showRemove();\n    } else {\n      galleryEndInfo();\n      showRemove();\n    }\n  } catch (err) {\n    return console.error(err);\n  }\n}\n\nfunction appendImagesToGallery(markup) {\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightBox();\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction createMarkup({\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n  <a href=\"${largeImageURL}\">\n  <div class=\"photo-card\">\n  <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes: </b>${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views: </b>${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments: </b>${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads: </b>${downloads}\n    </p>\n  </div>\n</div></a>\n  `;\n}\n\nfunction nextPage() {\n  page += 1;\n}\n\nfunction resetPage() {\n  page = 1;\n}\n\nfunction lightBox() {\n  lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nfunction totalImages(totalHits) {\n  Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n}\n\nfunction galleryEndInfo() {\n  if (totalHits / per_page < page - 1) {\n    showRemove();\n    Notiflix.Notify.success(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  }\n}\n"],"names":["$bpxeT","parcelRequire","$059fc1ddcc511c27$var$API_KEY","$059fc1ddcc511c27$var$BASE_URL","$059fc1ddcc511c27$var$page","$059fc1ddcc511c27$var$searchQuery","$059fc1ddcc511c27$var$totalHits","$059fc1ddcc511c27$var$lightbox","$059fc1ddcc511c27$var$searchImage","$059fc1ddcc511c27$var$_searchImage","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","response","$dIxxU","default","get","concat","_ctx","sent","data","totalHits","$059fc1ddcc511c27$var$nextPage","hits","$059fc1ddcc511c27$var$searchForm","document","querySelector","$059fc1ddcc511c27$var$gallery","addEventListener","e","$059fc1ddcc511c27$var$_onSearch","$059fc1ddcc511c27$var$loading","$059fc1ddcc511c27$var$showRemove","classList","remove","form","value","preventDefault","currentTarget","elements","searchQuery","trim","$059fc1ddcc511c27$var$resetPage","$059fc1ddcc511c27$var$clearGallery","$059fc1ddcc511c27$var$fetchImages","finally","reset","$059fc1ddcc511c27$var$_fetchImages","images","reduce","markup","image","$059fc1ddcc511c27$var$createMarkup","$059fc1ddcc511c27$var$appendImagesToGallery","refresh","$707g3","$6JpON","Notify","failure","$059fc1ddcc511c27$var$totalImages","$059fc1ddcc511c27$var$galleryEndInfo","console","error","t0","insertAdjacentHTML","$5IjG7","captionsData","captionDelay","innerHTML","param","largeImageURL","webformatURL","tags","likes","views","comments","downloads","totalHits1","success","window","_documentElement","documentElement","scrollTop","scrollHeight","clientHeight","log","add","setTimeout"],"version":3,"file":"infiniteScroll.170cbc56.js.map"}